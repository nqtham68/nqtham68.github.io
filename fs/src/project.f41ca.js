require=function i(r,s,l){function c(t,e){if(!s[t]){if(!r[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(u)return u(t,!0);var o=new Error("Cannot find module '"+t+"'");throw o.code="MODULE_NOT_FOUND",o}var a=s[t]={exports:{}};r[t][0].call(a.exports,function(e){return c(r[t][1][e]||e)},a,a.exports,i,r,s,l)}return s[t].exports}for(var u="function"==typeof require&&require,e=0;e<l.length;e++)c(l[e]);return c}({Multiplayer:[function(e,t,n){"use strict";cc._RF.push(t,"7a77aJhHHBO0oebSgbTBcNK","Multiplayer"),Object.defineProperty(n,"__esModule",{value:!0}),function(e){var u="lobbies",p="offers",r="answers",d="ices",t=function(){};e.RoomInfo=t;var h,n,m,o;(n=h=e.ErrorCode||(e.ErrorCode={}))[n.NONE=0]="NONE",n[n.ROOM_NOT_EXIST=1]="ROOM_NOT_EXIST",n[n.ROOM_FULL=2]="ROOM_FULL",n[n.NO_ROOM_ALIVE=3]="NO_ROOM_ALIVE",n[n.NOT_SUPPORTED=4]="NOT_SUPPORTED",(o=m=e.MessageCode||(e.MessageCode={}))[o.INITIALIZED=0]="INITIALIZED",o[o.PLAYER_JOINED=1]="PLAYER_JOINED",o[o.PLAYER_LEFT=2]="PLAYER_LEFT",o[o.PLAYER_DISCONNECT=3]="PLAYER_DISCONNECT",o[o.DATA_RECIEVED=4]="DATA_RECIEVED",o[o.GAME_STARTED=5]="GAME_STARTED",o[o.MASTER_ROOM_CHANGE=6]="MASTER_ROOM_CHANGE",o[o.KICKED_OUT=7]="KICKED_OUT",o[o.ROOM_CREATED=8]="ROOM_CREATED",o[o.ROOM_JOINED=9]="ROOM_JOINED";var a=function(){};e.Error=a;var i=function(){};e.Player=i;var y=function(){},s=function(){function e(e){this.rtcConfig={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:global.stun.twilio.com:3478?transport=udp"},{urls:"turn:turn.anyfirewall.com:443?transport=tcp",username:"webrtc",credential:"webrtc"},{urls:"turn:numb.viagenie.ca",username:"nqtham68@hotmail.com",credential:"123456?a"}]},this.gameId="",this.myRoomId="",this.myPlayer={id:"",name:"None"},this.masterPlayer={id:"",name:"None"},this.deathTime=18e5,this.gameStarted=!1,this.joinedRoom=!1,this.connections={},this.pendingIces={},this.players={},this.webrtc_support=!0,this.onMessage=null,this.init(e)}return e.prototype.init=function(e){var t=this;if(this.gameId=e,this.signalChannel=new l,this.signalChannel.setSignalingListener(this.onSignaling.bind(this)),this.signalChannel.init(e,function(){console.log("multiplayer manager initiallized"),t.onMessage&&t.onMessage(m.INITIALIZED,null),t.signalChannel.getTimeOffset(function(e){t.timeOffset=e,t.signalChannel.setConnect(!1)})}),RTCPeerConnection){var n=new RTCPeerConnection(null);n.createDataChannel||(this.webrtc_support=!1),n.close()}else this.webrtc_support=!1},e.prototype.startGame=function(){if(this.masterPlayer.id==this.myPlayer.id){var e=JSON.stringify({type:"__sys",message:"startgame"});for(var t in this.connections)this.connections[t].channel.send(e);this.gameStarted=!0,this.signalChannel.removeLobby(this.myRoomId),this.signalChannel.setConnect(!1)}else console.warn("Only host can start game")},e.prototype.setPlayerName=function(e){this.myPlayer.name=e},e.prototype.setPlayerId=function(e){this.myPlayer.id=e},e.prototype.getMyPlayer=function(){return this.myPlayer},e.prototype.getMasterPlayer=function(){return this.masterPlayer},e.prototype.isMaster=function(e){return this.masterPlayer.id===e},e.prototype.kickOut=function(e){this.masterPlayer.id==this.myPlayer.id?this.signalChannel.kickPlayer(this.myRoomId,{id:e,name:""}):console.warn("Only host can kick player out")},e.prototype.getPlayers=function(){return this.players},e.prototype.onSignaling=function(e,o){var a=this;if(e==l.SIGNAL_TYPE_OFFER){var n=new y;(this.connections[o.from.id]=n).peer=new RTCPeerConnection(this.rtcConfig),n.peer.setRemoteDescription(new RTCSessionDescription(JSON.parse(o.sdp))),n.peer.createAnswer(function(e){if(n.peer.setLocalDescription(e),console.log("Answer create and send to remote "+o.from.name),a.signalChannel.sendAnswer(a.myRoomId,a.myPlayer,o.from,e),a.pendingIces[o.from.id]){for(var t=0;t<a.pendingIces[o.from.id].length;t++)console.log("Add ice from: "+o.from.name),a.connections[o.from.id].peer.addIceCandidate(new RTCIceCandidate(JSON.parse(a.pendingIces[o.from.id][t])));a.pendingIces[o.from.id]=null}},function(e){console.warn("Create offer for "+o.from.name+" failed")}),n.peer.onicecandidate=function(e){n.peer&&e&&e.candidate&&a.signalChannel.sendCandidate(a.myRoomId,a.myPlayer,o.from,e.candidate)},n.peer.ondatachannel=function(e){n.channel=e.channel,n.channel.onclose=function(){console.log("connection: "+o.from.name+" is close"),a.gameStarted&&a.onMessage&&a.onMessage(m.PLAYER_DISCONNECT,o.from)},n.channel.onopen=function(){console.log("connection: "+o.from.name+" is open")},n.channel.onerror=function(e){console.log("connection: "+o.from.name+" is error: "+e)},n.channel.onmessage=function(e){console.log("connection: "+o.from.name+" has message: "+e.data);var t=null;try{t=JSON.parse(e.data)}catch(e){}if(t&&t.type&&"__sys"===t.type)"startgame"==t.message&&(a.gameStarted=!0,a.signalChannel.setConnect(!1),a.onMessage&&a.onMessage(m.GAME_STARTED,null));else{var n={player:{id:o.from.id,name:o.from.name},data:e.data};a.onMessage&&a.onMessage(m.DATA_RECIEVED,n)}},a.onMessage&&a.onMessage(m.PLAYER_JOINED,o.from),a.players[o.from.id]=o.from}}else if(e==l.SIGNAL_TYPE_ANSWER)null!=this.connections[o.from.id]?this.connections[o.from.id].peer.setRemoteDescription(new RTCSessionDescription(JSON.parse(o.sdp))):console.warn("Recieve answer for not exist player");else if(e==l.SIGNAL_TYPE_ICE)null!=this.connections[o.from.id]?this.connections[o.from.id].peer.addIceCandidate(new RTCIceCandidate(JSON.parse(o.sdp))):(this.pendingIces[o.from.id]||(this.pendingIces[o.from.id]=[]),this.pendingIces[o.from.id].push(o.sdp));else if(e==l.SIGNAL_TYPE_PLAYER_LEFT&&!this.gameStarted&&null!=this.myRoomId&&o){var t=o;this.myPlayer.id===t.id?(this.onMessage&&this.onMessage(m.KICKED_OUT,null),this.quit()):(this.onMessage&&this.onMessage(m.PLAYER_LEFT,t),this.masterPlayer.id===t.id&&this.signalChannel.changeMaster(this.myRoomId,function(e){console.log("Master change to: "+e),a.onMessage&&a.onMessage(m.MASTER_ROOM_CHANGE,e),a.masterPlayer=e})),this.connections[t.id]&&(this.connections[t.id].channel&&this.connections[t.id].channel.close(),this.connections[t.id].peer&&this.connections[t.id].peer.close(),delete this.connections[t.id]),delete this.players[t.id]}},e.prototype.createRoom=function(e,t,n,o,a){if(void 0===n&&(n=2),void 0===o&&(o=0),void 0===a&&(a={}),this.quit(),!this.webrtc_support)return t&&t({error:h.NOT_SUPPORTED,message:"WebRTC API is not support"},null),void(this.onMessage&&this.onMessage(m.ROOM_CREATED,{error:{error:h.NOT_SUPPORTED,message:"WebRTC API is not support"},room:null}));var i=this.signalChannel.createLobby(e,n,this.myPlayer,o,a);this.myRoomId=i,this.masterPlayer=this.myPlayer,this.joinedRoom=!0,this.players[this.myPlayer.id]=this.myPlayer;var r={id:i,title:e,master:this.myPlayer,maxPlayer:n,type:o,data:a,players:[this.myPlayer]};t&&t(null,r),this.onMessage&&this.onMessage(m.ROOM_CREATED,{room:r})},e.prototype.joinRoom=function(s,l){var c=this;if(this.quit(),!this.webrtc_support)return l&&l({error:h.NOT_SUPPORTED,message:"WebRTC API is not support"},null),void(this.onMessage&&this.onMessage(m.ROOM_JOINED,{error:{error:h.NOT_SUPPORTED,message:"WebRTC API is not support"},room:null}));this.joinedRoom=!1,this.signalChannel.queryData(u+"/"+s,function(n){if(null!=n&&null!=n.id){var e=null!=n.players?Object.keys(n.players).length:-1;if(0<e)if(e>=n.maxPlayer)console.warn("Room is full"),l&&l({error:h.ROOM_FULL,message:"Room is full"},null);else if(Date.now()+c.timeOffset-n.created>c.deathTime)console.warn("Death room"),l&&l({error:h.ROOM_NOT_EXIST,message:"Death room"},null);else{var t=c.signalChannel.joinLobby(s,c.myPlayer);c.myRoomId=t,c.masterPlayer=n.master;var a=[],o=function(e){var o=n.players[e];if(!o.player)return c.signalChannel.kickPlayer(c.myRoomId,{id:e,name:""}),"continue";var t=new y;t.peer=new RTCPeerConnection(c.rtcConfig),t.channel=t.peer.createDataChannel("mpchannel"),(c.connections[e]=t).channel.onclose=function(){console.log("connection: "+o.player.name+" is close"),c.gameStarted&&c.onMessage&&c.onMessage(m.PLAYER_DISCONNECT,o.player.id)},t.channel.onopen=function(){console.log("connection: "+o.player.name+" is open")},t.channel.onerror=function(e){console.log("connection: "+o.player.name+" is error: "+e)},t.channel.onmessage=function(e){console.log("connection: "+o.player.name+" has message: "+e.data);var t=null;try{t=JSON.parse(e.data)}catch(e){}if(t&&t.type&&"__sys"===t.type)"startgame"==t.message&&(c.gameStarted=!0,c.onMessage&&c.onMessage(m.GAME_STARTED,null));else{var n={player:o.player,data:e.data};c.onMessage&&c.onMessage(m.DATA_RECIEVED,n)}},t.peer.createOffer(function(e){t.peer.setLocalDescription(e),console.log("Offer create and send to remote "+o.player.name),c.signalChannel.sendOffer(c.myRoomId,c.myPlayer,o.player,e)},function(e){console.warn("Create offer for "+o.player+" failed")}),t.peer.onicecandidate=function(e){t.peer&&e&&e.candidate&&c.signalChannel.sendCandidate(c.myRoomId,c.myPlayer,o.player,e.candidate)},a.push(o.player),c.players[o.player.id]=o.player};for(var i in n.players)o(i);a.push(c.myPlayer),c.players[c.myPlayer.id]=c.myPlayer;var r={id:t,title:n.title,master:n.master,maxPlayer:n.maxPlayer,type:n.type,data:n.data,players:a};c.joinRoomTimeoutId=setTimeout(function(){console.log("Join room time out"),c.quit(),l&&l({error:h.ROOM_NOT_EXIST,message:"Join room time out"},null)},6e4),c.joinRoomUpdateIntervalId=setInterval(function(){var e=!0;for(var t in c.connections)c.connections[t].channel&&"open"==c.connections[t].channel.readyState||(e=!1);e&&!c.joinedRoom&&(c.joinedRoom=!0,clearTimeout(c.joinRoomTimeoutId),clearInterval(c.joinRoomUpdateIntervalId),l&&l(null,r),c.onMessage&&c.onMessage(m.ROOM_JOINED,{room:r}))},1e3/15)}else console.warn("Room is empty"),c.signalChannel.cleanEmptyRoom(),l&&l({error:h.ROOM_NOT_EXIST,message:"Room does not exist"},null)}else console.warn("Room does not exist"),l&&l({error:h.ROOM_NOT_EXIST,message:"Room does not exist"},null)})},e.prototype.quickJoin=function(o,e){var a=this;void 0===e&&(e=0),this.quit(),this.getRoomsType(e,function(e){if(0<e.length){for(var t=new c(e.length),n=t.random();-1<n;){if(e[n].playerInRoom<e[n].maxPlayer){a.joinRoom(e[Math.floor(Math.random()*e.length)].id,o);break}n=t.random()}n<0&&o&&o({error:h.NO_ROOM_ALIVE,message:"There have no room alive"},null)}else o&&o({error:h.NO_ROOM_ALIVE,message:"There have no room alive"},null)})},e.prototype.quit=function(e){if(void 0===e&&(e=null),null!=this.myRoomId&&""!=this.myRoomId){for(var t in this.signalChannel.quitLobby(this.myRoomId,this.myPlayer,function(){e&&e()}),clearTimeout(this.joinRoomTimeoutId),clearInterval(this.joinRoomUpdateIntervalId),this.gameStarted=!1,this.joinedRoom=!1,this.myRoomId="",this.connections)this.connections[t].channel&&this.connections[t].channel.close(),this.connections[t].peer&&this.connections[t].peer.close();this.connections={},this.pendingIces={},this.players={},this.signalChannel.setConnect(!1)}},e.prototype.getRoomsType=function(i,r){var s=this;this.signalChannel.queryData(u,function(e){var t=[];for(var n in e){var o=Date.now()+s.timeOffset-e[n].created>s.deathTime,a=e[n].players[s.myPlayer.id];e[n].type!=i&&null!=i||null==e[n].players||o||a||t.push(e[n])}r(t)})},e.prototype.getRooms=function(e){this.getRoomsType(null,e)},e.prototype.sendMessage=function(e){for(var t in this.connections)this.connections[t].channel.send(e)},e.prototype.sendMessageTo=function(e,t){this.connections[e]&&this.connections[e].channel.send(t)},e}();e.Manager=s;var l=function(){function c(){}return c.prototype.init=function(e,n){var o=this;this.gameId=e;this.firebaseApp=firebase.initializeApp({apiKey:"AIzaSyBbEcsnkmPtPsaATElA94sWNVbxLjXUhdE",authDomain:"webrtcmultiplay.firebaseapp.com",databaseURL:"https://webrtcmultiplay.firebaseio.com",projectId:"webrtcmultiplay",storageBucket:"webrtcmultiplay.appspot.com",messagingSenderId:"508433943022"},"multiplay");var a=this.firebaseApp.database();a.ref(e).once("value",function(t){t.exists()?(o.firebaseDb=a.ref(e),t.child(u).forEach(function(e){return e.child("players").exists()||t.child(u+"/"+e.key).ref.remove(),!1})):(a.ref(e).set({created:firebase.database.ServerValue.TIMESTAMP,rooms:[],lobbies:[]}),o.firebaseDb=a.ref(e));o.lobbyRef=o.firebaseDb.child(u),n&&n()})},c.prototype.setSignalingListener=function(e){this.signalListener=e},c.prototype.createLobby=function(e,t,n,o,a){var i=this;this.setConnect(!0);var r=this.lobbyRef.child(f.generateID()),s=""==n.id?this.lobbyRef.child(r.key+"/players").push().key:n.id;n.id=s;var l={created:firebase.database.ServerValue.TIMESTAMP,id:r.key,title:e,playerInRoom:1,maxPlayer:t,master:n,type:o,data:a,players:{}};return r.set(l),r.child("/players/"+s).set({player:n}),this.lobbyRef.child(r.key+"/players/"+s+"/"+p).on("child_added",function(e){i.signalListener(c.SIGNAL_TYPE_OFFER,e.toJSON()),e.ref.remove()}),this.lobbyRef.child(r.key+"/players/"+s+"/"+d).on("child_added",function(e){e.ref.on("child_added",function(e){i.signalListener(c.SIGNAL_TYPE_ICE,e.toJSON()),e.ref.remove()})}),this.lobbyRef.child(r.key+"/players").on("value",function(e){null!=e.val()&&i.lobbyRef.child(r.key+"/playerInRoom").set(e.numChildren())}),this.lobbyRef.child(r.key+"/players").on("child_removed",function(e){e.val().player&&i.signalListener(c.SIGNAL_TYPE_PLAYER_LEFT,e.val().player)}),this.lobbyRef.child(r.key+"/players/"+s).onDisconnect().remove(),r.key},c.prototype.joinLobby=function(t,e){var n=this;this.setConnect(!0);var o=""==e.id?this.lobbyRef.child(t+"/players").push().key:e.id;return e.id=o,this.lobbyRef.child(t+"/players/"+o).set({player:e}),this.lobbyRef.child(t+"/players/"+o+"/"+p).on("child_added",function(e){n.signalListener(c.SIGNAL_TYPE_OFFER,e.toJSON()),e.ref.remove()}),this.lobbyRef.child(t+"/players/"+o+"/"+r).on("child_added",function(e){n.signalListener(c.SIGNAL_TYPE_ANSWER,e.toJSON()),e.ref.remove()}),this.lobbyRef.child(t+"/players/"+o+"/"+d).on("child_added",function(e){e.ref.on("child_added",function(e){n.signalListener(c.SIGNAL_TYPE_ICE,e.toJSON()),e.ref.remove()})}),this.lobbyRef.child(t+"/players").on("value",function(e){null!=e.val()&&n.lobbyRef.child(t+"/playerInRoom").set(e.numChildren())}),this.lobbyRef.child(t+"/players").on("child_removed",function(e){e.val().player&&n.signalListener(c.SIGNAL_TYPE_PLAYER_LEFT,e.val().player)}),this.lobbyRef.child(t+"/players/"+o).onDisconnect().remove(),t},c.prototype.quitLobby=function(t,e,n){var o=this;this.lobbyRef.child(t+"/players").off(),this.lobbyRef.child(t+"/players/"+e.id).remove().then(function(){return n(),o.lobbyRef.child(t+"/players").once("value")}).then(function(e){e.hasChildren()||o.lobbyRef.child(t).remove()})},c.prototype.removeLobby=function(e){e&&""!=e&&this.lobbyRef.child(e).remove()},c.prototype.kickPlayer=function(e,t){this.lobbyRef.child(e+"/players/"+t.id).remove()},c.prototype.sendOffer=function(t,n,o,a){var i=this;this.lobbyRef.child(t+"/players").once("value",function(e){e&&e.exists()&&e.child(n.id).exists()&&e.child(o.id).exists()&&i.lobbyRef.child(t+"/players/"+o.id+"/"+p+"/"+n.id).set({from:n,sdp:JSON.stringify(a)})})},c.prototype.sendAnswer=function(t,n,o,a){var i=this;this.lobbyRef.child(t+"/players").once("value",function(e){e&&e.exists()&&e.child(n.id).exists()&&e.child(o.id).exists()&&i.lobbyRef.child(t+"/players/"+o.id+"/"+r+"/"+n.id).set({from:n,sdp:JSON.stringify(a)})})},c.prototype.sendCandidate=function(t,n,o,a){var i=this;this.lobbyRef.child(t+"/players").once("value",function(e){e&&e.exists()&&e.child(n.id).exists()&&e.child(o.id).exists()&&i.lobbyRef.child(t+"/players/"+o.id+"/"+d+"/"+n.id).push({from:n,sdp:JSON.stringify(a)})})},c.prototype.queryData=function(e,t){this.setConnect(!0),this.firebaseDb.child(e).once("value",function(e){t(e.toJSON())})},c.prototype.getTimeOffset=function(t){this.firebaseApp.database().ref(".info/serverTimeOffset").once("value",function(e){t(e.val())})},c.prototype.changeMaster=function(n,o){var a=this;this.lobbyRef.child(n+"/players").limitToFirst(1).once("value",function(e){var t=e.val()[Object.keys(e.val())[0]].player;a.lobbyRef.child(n+"/master").set(t),o(t)})},c.prototype.cleanEmptyRoom=function(){var t=this;this.lobbyRef.once("value",function(e){e.forEach(function(e){return e.child("players").exists()||t.lobbyRef.child(e.key).remove(),!1})})},c.prototype.setConnect=function(e){e?this.firebaseApp.database().goOnline():this.firebaseApp.database().goOffline()},c.SIGNAL_TYPE_OFFER="offer",c.SIGNAL_TYPE_ANSWER="answer",c.SIGNAL_TYPE_ICE="ice",c.SIGNAL_TYPE_PLAYER_LEFT="player_left",c}(),f=function(){function e(){}return e.generateID=function(){var e=46656*Math.random()|0,t=46656*Math.random()|0;return("000"+e.toString(36)).slice(-3)+("000"+t.toString(36)).slice(-3)},e}(),c=function(){function e(e,t){void 0===t&&(t=!1),this.unique=[],this.initLength=-1,this.recycle=!1,this.initLength=e,this.recycle=t;for(var n=0;n<e;n++)this.unique[n]=n}return e.prototype.random=function(){if(0==this.unique.length){if(!this.recycle||-1==this.initLength)return-1;for(var e=0;e<this.initLength;e++)this.unique[e]=e}var t=Math.floor(Math.random()*this.unique.length),n=this.unique[t];return this.unique.splice(t,1),n},e}()}(n.multiplayer||(n.multiplayer={})),cc._RF.pop()},{}],"animation-in-out":[function(e,t,n){"use strict";cc._RF.push(t,"f7777byGX1OnpX1HPI2yThK","animation-in-out"),Object.defineProperty(n,"__esModule",{value:!0});var o=cc._decorator,a=o.ccclass,i=(o.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.anim=null,e}return __extends(e,t),e.prototype.onLoad=function(){this.anim=this.node.getComponent(cc.Animation)},e.prototype.onEnable=function(){this.anim.play(this.anim.defaultClip.name)},e=__decorate([a],e)}(cc.Component));n.default=i,cc._RF.pop()},{}],"boss-input":[function(e,t,n){"use strict";cc._RF.push(t,"78625QBGwZGy4SxEtl/+Ft5","boss-input"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("../core/event-manager"),a=e("./game"),i=function(){function e(){this.gameEnd=!1,this.shoot3Count=0,this.player=null,this.gameMode=null}return e.prototype.init=function(e,t){return this.gameMode=t,this.player=e,o.default.instance.registerOnce("start-fight",this.onFight,this),this},e.prototype.onFight=function(){var e=this;if(this.player.startFightTime=Date.now(),this.gameMode==a.GameMode.ONE_SHOOT){var t=10+590*cc.random0To1();cc.log("boss shoot time: "+t),setTimeout(function(){e.player.shoot1()},t)}else if(this.gameMode==a.GameMode.THREE_SHOOT){var n=100+600*cc.random0To1();setTimeout(this.shoot3Mode.bind(this),n)}},e.prototype.shoot3Mode=function(){var e=Math.round(cc.random0To1());if(this.shoot3Count++,this.shoot3Count<6){this.player.shoot3(0==e);var t=100+600*cc.random0To1();setTimeout(this.shoot3Mode.bind(this),t)}},e}();n.default=i,cc._RF.pop()},{"../core/event-manager":"event-manager","./game":"game"}],config:[function(e,t,n){"use strict";cc._RF.push(t,"c6efbbGajtDX47bDRlGSj62","config"),Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(){}return e.PROJECT_ID="FastestShoot",e}();n.default=o,cc._RF.pop()},{}],"count-down":[function(e,t,n){"use strict";cc._RF.push(t,"9be3eOwTN9ETLSxqzihqyF+","count-down"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("../core/event-manager"),a=cc._decorator,i=a.ccclass,r=(a.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.anim=null,e}return __extends(e,t),e.prototype.onLoad=function(){var e=this;this.anim=this.node.getComponent(cc.Animation),this.node.active=!1,o.default.instance.registerOnce("start-countdown",function(){cc.log("start count down"),e.node.active=!0,e.anim.play(e.anim.defaultClip.name)},this)},e.prototype.onFight=function(){o.default.instance.dispatch("start-fight")},e.prototype.onDestroy=function(){o.default.instance.unregisterTarget(this)},e=__decorate([i],e)}(cc.Component));n.default=r,cc._RF.pop()},{"../core/event-manager":"event-manager"}],"event-manager":[function(e,t,n){"use strict";cc._RF.push(t,"6793aH0I3NJm6wSOX4/SOAz","event-manager"),Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(){this.eventListenners={}}return Object.defineProperty(e,"instance",{get:function(){return null==e._instance&&(e._instance=new e),e._instance},enumerable:!0,configurable:!0}),e.prototype.register=function(e,t,n,o,a){void 0===n&&(n=null),void 0===o&&(o=0),void 0===a&&(a=!1);var i={target:n,callback:t,priority:o,excuteOnce:a};return this.eventListenners[e]||(this.eventListenners[e]=[]),this.eventListenners[e].push(i),this.eventListenners[e].sort(function(e,t){return t.priority-e.priority}),t},e.prototype.registerOnce=function(e,t,n,o){void 0===n&&(n=null),void 0===o&&(o=0),this.register(e,t,n,o,!0)},e.prototype.unregister=function(e,t,n){if(void 0===n&&(n=null),this.eventListenners[e]){for(var o=[],a=0;a<this.eventListenners[e].length;a++){var i=this.eventListenners[e][a];null==t?i.target==n&&o.push(a):i.target==n&&i.callback==t&&o.push(a)}this.eventListenners[e]=this.eventListenners[e].filter(function(e,t){return-1===o.indexOf(t)}),0==this.eventListenners[e].length&&delete this.eventListenners[e]}},e.prototype.unregisterTarget=function(o){var e=function(e){for(var n=[],t=0;t<a.eventListenners[e].length;t++){a.eventListenners[e][t].target==o&&n.push(t)}a.eventListenners[e]=a.eventListenners[e].filter(function(e,t){return-1===n.indexOf(t)}),0==a.eventListenners[e].length&&delete a.eventListenners[e]},a=this;for(var t in this.eventListenners)e(t)},e.prototype.remove=function(e){this.eventListenners[e]&&delete this.eventListenners[e]},e.prototype.dispatch=function(t){for(var n=this,o=[],e=1;e<arguments.length;e++)o[e-1]=arguments[e];if(this.eventListenners[t]){var a=[];this.eventListenners[t].forEach(function(e){e.target?e.callback.call(e.target,o[0],o[1],o[2],o[3],o[4],o[5],o[6],o[7],o[8],o[9]):e.callback(o[0],o[1],o[2],o[3],o[4],o[5],o[6],o[7],o[8],o[9]),1==e.excuteOnce&&a.push(e)}),a.forEach(function(e){n.unregister(t,e.callback,e.target)})}},e._instance=null,e}();n.default=o,cc._RF.pop()},{}],"firebase-inst":[function(e,t,n){"use strict";cc._RF.push(t,"cdc76aytsdLKaoZNoZVQ7Qj","firebase-inst"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("../config"),a=function(){function e(){}return Object.defineProperty(e,"app",{get:function(){if(this._app)return this._app;cc.warn("Firebase instance is not init yet")},enumerable:!0,configurable:!0}),Object.defineProperty(e,"db",{get:function(){if(this._db)return this._db;cc.warn("Firebase instance is not init yet")},enumerable:!0,configurable:!0}),e.init=function(){null==this._app&&(cc.log("Init firebase inst"),this._app=firebase.initializeApp(this.config),this._db=this._app.database().ref(o.default.PROJECT_ID))},e.config={apiKey:"AIzaSyAbtm9DVqNFcMz0MDuVAND27Dshh2TfAcE",authDomain:"gameleaderboard-49a78.firebaseapp.com",databaseURL:"https://gameleaderboard-49a78.firebaseio.com",projectId:"gameleaderboard-49a78",storageBucket:"gameleaderboard-49a78.appspot.com",messagingSenderId:"311807796451"},e}();n.default=a,cc._RF.pop()},{"../config":"config"}],game:[function(e,t,n){"use strict";cc._RF.push(t,"1b1f6U+wpBNTJQW3qxrpGGS","game"),Object.defineProperty(n,"__esModule",{value:!0});var i,o,a,r,s=e("./multiplayer-inst"),l=e("../libs/Multiplayer"),c=e("../core/event-manager"),u=e("../core/transport-message"),p=e("./tapzone"),d=e("../core/loader"),h=e("./boss-input"),m=e("./player-behavior"),y=e("./local-input"),f=e("./player"),g=e("./remote-input"),_=e("../core/popup"),b=e("../libs/leaderboard-db"),v=cc._decorator,R=v.ccclass,T=v.property,M=v.executionOrder;(o=i=n.GameState||(n.GameState={}))[o.LOADING=0]="LOADING",o[o.COUNT_DOWN=1]="COUNT_DOWN",o[o.FIGHTING=2]="FIGHTING",o[o.END=3]="END",(r=a=n.GameMode||(n.GameMode={}))[r.ONE_SHOOT=1]="ONE_SHOOT",r[r.THREE_SHOOT=3]="THREE_SHOOT";var P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.resultText=null,e.mainButton=null,e.rematchButton=null,e.tapzone=null,e.leftPlayer=null,e.rightPlayer=null,e.state=i.LOADING,e.shootMode=a.ONE_SHOOT,e.isMultiplayer=!1,e.zones=null,e.localPlayer=null,e.remotePlayer=null,e.rematch=!1,e}return __extends(e,t),Object.defineProperty(e.prototype,"gameState",{get:function(){return this.state},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gameMode",{get:function(){return this.shootMode},enumerable:!0,configurable:!0}),e.prototype.onLoad=function(){var o=this;if(d.default.loaded){null!=u.default.instance.get("gameplay","multiplayer")&&(this.isMultiplayer=!0);var e=u.default.instance.get("gameplay","mode");if(null!=e&&(this.shootMode=parseInt(e)),c.default.instance.registerOnce("start-fight",function(){o.state=i.FIGHTING,o.shootMode==a.THREE_SHOOT&&(o.zones=p.TapZoneGen.generateZone(6)),o.shootMode==a.THREE_SHOOT&&o.zones.forEach(function(e,t){var n=cc.instantiate(o.tapzone);n.getComponent(p.default).setType(t%2),n.setPosition(e.x,e.y),o.node.addChild(n)})},this),this.isMultiplayer)for(var t in c.default.instance.register("multiplayer-message",this.onMpMessage,this),this.localPlayer=s.default.instance.localPlayer,this.localPlayer.setBehavior(this.leftPlayer),(new y.LocalInput).init(this.localPlayer,this.gameMode),s.default.instance.players){var n=s.default.instance.players[t];n.id!=this.localPlayer.id&&(this.remotePlayer=n,this.remotePlayer.setBehavior(this.rightPlayer),(new g.default).init())}else this.remotePlayer=new f.default("boss","Boss",f.PlayerType.BOSS,!1),this.remotePlayer.setBehavior(this.rightPlayer),this.remotePlayer.loaded=!0,(new h.default).init(this.remotePlayer,this.gameMode),this.localPlayer=new f.default("local",cc.sys.localStorage.getItem("user-name"),f.PlayerType.LOCAL,!1),this.localPlayer.setBehavior(this.leftPlayer),(new y.LocalInput).init(this.localPlayer,this.gameMode)}},e.prototype.start=function(){d.default.loaded&&(this.localPlayer.loaded=!0,0==this.isMultiplayer&&(this.state=i.COUNT_DOWN,c.default.instance.dispatch("start-countdown")))},e.prototype.update=function(e){if(dragonBones.WorldClock.clock.advanceTime(e),this.isMultiplayer&&this.state==i.LOADING&&s.default.instance.amIMaster()&&s.default.instance.allPlayerReady()&&(s.default.instance.sendMessage(f.PlayerMessage.START),this.state=i.COUNT_DOWN,c.default.instance.dispatch("start-countdown")),this.state==i.FIGHTING)if(this.gameMode==a.ONE_SHOOT)if(0!=this.localPlayer.shootTime&&0!=this.remotePlayer.shootTime){var t=this.localPlayer.shootTime==this.remotePlayer.shootTime?0:this.localPlayer.shootTime<this.remotePlayer.shootTime?1:2;this.showResult(t)}else 0!=this.localPlayer.shootTime&&Date.now()-this.localPlayer.startFightTime>this.localPlayer.shootTime+500?this.showResult(1):0!=this.remotePlayer.shootTime&&Date.now()-this.localPlayer.startFightTime>this.remotePlayer.shootTime&&this.showResult(2);else this.gameMode==a.THREE_SHOOT&&(3==this.localPlayer.shootZone.safe&&3==this.remotePlayer.shootZone.safe?this.localPlayer.shootTime<this.remotePlayer.shootTime?this.showResult(1):this.localPlayer.shootTime>this.remotePlayer.shootTime?this.showResult(2):this.showResult(0):3==this.localPlayer.shootZone.unsafe&&3==this.remotePlayer.shootZone.unsafe?this.localPlayer.shootTime<this.remotePlayer.shootTime?this.showResult(2):this.localPlayer.shootTime>this.remotePlayer.shootTime?this.showResult(1):this.showResult(0):3==this.localPlayer.shootZone.safe?this.showResult(1):3==this.remotePlayer.shootZone.safe?this.showResult(2):3==this.localPlayer.shootZone.unsafe?this.showResult(2):3==this.remotePlayer.shootZone.unsafe&&this.showResult(1))},e.prototype.onMpMessage=function(e,t){var n=this,o=t;if(e==l.multiplayer.MessageCode.DATA_RECIEVED){cc.log("data receive: "+t.data);var a=JSON.parse(o.data);a.type==f.PlayerMessage.START?(this.state=i.COUNT_DOWN,c.default.instance.dispatch("start-countdown")):a.type==f.PlayerMessage.REMATCH&&(null==a.data?_.default.instance.showConfirmPopup(o.player.name+" want to Re-match?","OK","Cancel",function(){s.default.instance.sendMessage(f.PlayerMessage.REMATCH,"OK"),n.rematch=!0,u.default.instance.send("gameplay","multiplayer","true"),u.default.instance.send("gameplay","mode",""+n.gameMode),cc.director.loadScene("game")},function(){s.default.instance.sendMessage(f.PlayerMessage.REMATCH,"CA")}):"OK"==a.data?(this.rematch=!0,u.default.instance.send("gameplay","multiplayer","true"),u.default.instance.send("gameplay","mode",""+this.gameMode),cc.director.loadScene("game")):"CA"==a.data&&(_.default.instance.showInfoPopup(o.player.name+" do not want Re-match"),this.rematchButton.node.active=!1))}else e==l.multiplayer.MessageCode.PLAYER_DISCONNECT&&(this.state!=i.END?_.default.instance.showNotify(o.player.name+" disconnect"):this.rematchButton.node.active=!1)},e.prototype.showResult=function(e){this.resultText.node.active=!0,this.mainButton.node.active=!0,this.rematchButton.node.active=!0,0==e?(cc.log("raw"),this.resultText.string="Raw",this.localPlayer.setResult(f.PlayerResult.RAW),this.remotePlayer.setResult(f.PlayerResult.RAW)):1==e?(cc.log("win"),this.resultText.string="You Win",this.localPlayer.setResult(f.PlayerResult.WIN),this.remotePlayer.setResult(f.PlayerResult.LOSE),this.isMultiplayer&&b.LeaderboardDb.instance.addScore(this.localPlayer.id,this.localPlayer.name,2)):2==e&&(cc.log("lose"),this.resultText.string="You Lose",this.localPlayer.setResult(f.PlayerResult.LOSE),this.remotePlayer.setResult(f.PlayerResult.WIN)),this.state=i.END,c.default.instance.dispatch("zone-destroy")},e.prototype.onDestroy=function(){this.rematch?s.default.instance.rematch():s.default.instance.reset(),c.default.instance.remove("multiplayer-message"),c.default.instance.unregisterTarget(this)},e.prototype.onMainmenuButton=function(){cc.director.loadScene("main-menu")},e.prototype.onRematchButton=function(){this.isMultiplayer?s.default.instance.sendMessage(f.PlayerMessage.REMATCH,null):(this.rematch=!0,u.default.instance.send("gameplay","mode",""+this.gameMode),cc.director.loadScene("game"))},__decorate([T(cc.Label)],e.prototype,"resultText",void 0),__decorate([T(cc.Button)],e.prototype,"mainButton",void 0),__decorate([T(cc.Button)],e.prototype,"rematchButton",void 0),__decorate([T(cc.Prefab)],e.prototype,"tapzone",void 0),__decorate([T(m.default)],e.prototype,"leftPlayer",void 0),__decorate([T(m.default)],e.prototype,"rightPlayer",void 0),e=__decorate([R,M(-1)],e)}(cc.Component);n.default=P,cc._RF.pop()},{"../core/event-manager":"event-manager","../core/loader":"loader","../core/popup":"popup","../core/transport-message":"transport-message","../libs/Multiplayer":"Multiplayer","../libs/leaderboard-db":"leaderboard-db","./boss-input":"boss-input","./local-input":"local-input","./multiplayer-inst":"multiplayer-inst","./player":"player","./player-behavior":"player-behavior","./remote-input":"remote-input","./tapzone":"tapzone"}],"lb-item":[function(e,t,n){"use strict";cc._RF.push(t,"1ec0fZobTdFebM83sEocCHH","lb-item"),Object.defineProperty(n,"__esModule",{value:!0});var o=cc._decorator,a=o.ccclass,i=o.property,r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rank=null,e.nickname=null,e.score=null,e}return __extends(e,t),e.prototype.setData=function(e,t,n){this.rank.string=e,this.nickname.string=t,this.score.string=""+n},__decorate([i(cc.Label)],e.prototype,"rank",void 0),__decorate([i(cc.Label)],e.prototype,"nickname",void 0),__decorate([i(cc.Label)],e.prototype,"score",void 0),e=__decorate([a],e)}(cc.Component);n.default=r,cc._RF.pop()},{}],"leaderboard-db":[function(e,t,n){"use strict";cc._RF.push(t,"052b0H/ZzBLhqpQwE2h1Eqi","leaderboard-db"),Object.defineProperty(n,"__esModule",{value:!0});var o,a,i=e("./firebase-inst"),r=function(){function o(){null==i.default.app&&i.default.init()}return Object.defineProperty(o,"instance",{get:function(){return null==this._intance&&(this._intance=new o),this._intance},enumerable:!0,configurable:!0}),o.prototype.updateName=function(e,t,n){i.default.db.child(e).once("value",function(e){e&&e.exists()?(e.ref.child("name").set(t),n&&n(null)):n&&n({error:o.ErrorCode.ID_NOT_EXIST,message:"Id is not exist in db"})})},o.prototype.updateScore=function(e,t,n,o){void 0===o&&(o=!0),i.default.db.child(e).once("value",function(e){e&&e.exists()?o?e.val().score<=n&&(e.ref.child("score").set(n),e.ref.child("name").set(t)):e.val().score>=n&&(e.ref.child("score").set(n),e.ref.child("name").set(t)):(e.ref.child("score").set(n),e.ref.child("name").set(t))})},o.prototype.addScore=function(e,n,o,a){void 0===a&&(a=!0),i.default.db.child(e).once("value",function(e){if(e&&e.exists())if(a){var t=e.val().score+o;e.ref.child("score").set(t),e.ref.child("name").set(n)}else{t=e.val().score-o;e.ref.child("score").set(t),e.ref.child("name").set(n)}else e.ref.child("score").set(o),e.ref.child("name").set(n)})},o.prototype.getTopScore=function(e,n,t){void 0===t&&(t=!0),t?i.default.db.orderByChild("score").limitToLast(e).once("value",function(e){var t=[];e.forEach(function(e){return t.unshift({name:e.val().name,score:e.val().score}),!1}),n(t)}):i.default.db.orderByChild("score").limitToFirst(e).once("value",function(e){var t=[];e.forEach(function(e){return t.push({name:e.val().name,score:e.val().score}),!1}),n(t)})},o._intance=null,o}();n.LeaderboardDb=r,o=r=n.LeaderboardDb||(n.LeaderboardDb={}),(a=o.ErrorCode||(o.ErrorCode={}))[a.ID_NOT_EXIST=0]="ID_NOT_EXIST",n.LeaderboardDb=r,cc._RF.pop()},{"./firebase-inst":"firebase-inst"}],leaderboard:[function(e,t,n){"use strict";cc._RF.push(t,"239b0UXVPZDmq+fy6TqD/5P","leaderboard"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("../libs/leaderboard-db"),a=e("./lb-item"),i=cc._decorator,r=i.ccclass,s=i.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.db=null,e.leaderboardItem=null,e}return __extends(e,t),e.prototype.onLoad=function(){this.db=o.LeaderboardDb.instance,this.anim=this.node.getComponent(cc.Animation),this.content=this.node.getComponentInChildren(cc.Layout)},e.prototype.getLbDate=function(){var o=this;this.content.node.removeAllChildren(),this.db.getTopScore(10,function(e){e.forEach(function(e,t){var n=cc.instantiate(o.leaderboardItem);n.getComponent(a.default).setData(t+1+".",e.name,e.score),o.content.node.addChild(n)}),o.content.node.parent.getComponent(cc.ScrollView).scrollToTop()})},e.prototype.onButtonClose=function(){var t=this;this.anim.play(this.anim.defaultClip.name).wrapMode=cc.WrapMode.Reverse,this.anim.once("finished",function(e){t.node.active=!1})},e.prototype.onEnable=function(){this.anim.play(this.anim.defaultClip.name).wrapMode=cc.WrapMode.Normal,this.getLbDate()},__decorate([s(cc.Prefab)],e.prototype,"leaderboardItem",void 0),e=__decorate([r],e)}(cc.Component);n.default=l,cc._RF.pop()},{"../libs/leaderboard-db":"leaderboard-db","./lb-item":"lb-item"}],loader:[function(e,t,n){"use strict";cc._RF.push(t,"b6f23VlUYJJobWp0yQ2rNvo","loader"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("./transport-message"),a=e("../player-ref"),i=e("../libs/firebase-inst"),r=e("../game/multiplayer-inst"),s=e("./event-manager"),l=cc._decorator,c=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nextScene="main-menu",e.targetLoad="",e._loadInstances={PlayerRef:!1,Multiplayer:!1},e._loadGame=!1,e}return __extends(e,t),(n=e).prototype.onLoad=function(){if(0==n.loaded)if("loader"!=this.getCurrentSceneName()){var e=""!=this.targetLoad?this.targetLoad:this.getCurrentSceneName();o.default.instance.send("loader","nextScene",e),cc.director.loadScene("loader")}else{n.loaded=!0;var t=o.default.instance.get("loader","nextScene");this.nextScene=null!=t?t:this.nextScene}},e.prototype.start=function(){"loader"==this.getCurrentSceneName()&&this.initLoader()},e.prototype.initLoader=function(){var e=this;i.default.init(),a.default.current,r.default.instance,s.default.instance.registerOnce("PlayerRef-init",function(){e._loadInstances.PlayerRef=!0}),s.default.instance.registerOnce("Multiplayer-init",function(){e._loadInstances.Multiplayer=!0})},e.prototype.update=function(e){var t=!0;for(var n in this._loadInstances)if(0==this._loadInstances[n]){t=!1;break}t&&!this._loadGame&&(this._loadGame=!0,cc.director.loadScene(this.nextScene))},e.prototype.getCurrentSceneName=function(){var t="";return cc.game._sceneInfos.forEach(function(e){e.uuid==cc.director._scene._id&&(t=(t=e.url).substring(t.lastIndexOf("/")+1).match(/[^\.]+/)[0])}),t},e.loaded=!1,__decorate([u],e.prototype,"targetLoad",void 0),e=n=__decorate([c],e);var n}(cc.Component);n.default=p,cc._RF.pop()},{"../game/multiplayer-inst":"multiplayer-inst","../libs/firebase-inst":"firebase-inst","../player-ref":"player-ref","./event-manager":"event-manager","./transport-message":"transport-message"}],"lobby-player-item":[function(e,t,n){"use strict";cc._RF.push(t,"3f1079S3K1Pn5YQIXKSk6as","lobby-player-item"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("../game/multiplayer-inst"),a=cc._decorator,i=a.ccclass,r=a.property,s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.playerName=null,e.kickButton=null,e.master=!1,e.anim=null,e}return __extends(e,t),e.prototype.onLoad=function(){this.anim=this.node.getComponentInChildren(cc.Animation),this.kickButton.node.active=!1},e.prototype.setData=function(e,t,n){null==e||""==e?(cc.log("player left"),this.anim.play(this.anim.defaultClip.name).wrapMode=cc.WrapMode.Reverse,this.playerName.string="wating...",this.kickButton.node.active=!1):(this.playerId=e,this.playerName.string=t,this.setMaster(n),this.anim.play(this.anim.defaultClip.name).wrapMode=cc.WrapMode.Default,this.playerId==o.default.instance.manager.getMyPlayer().id&&(this.kickButton.node.active=!1))},e.prototype.setMaster=function(e){this.kickButton.node.active=!e,this.master=e},e.prototype.onButtonKickOut=function(){o.default.instance.manager.kickOut(this.playerId)},__decorate([r(cc.Label)],e.prototype,"playerName",void 0),__decorate([r(cc.Button)],e.prototype,"kickButton",void 0),e=__decorate([i],e)}(cc.Component);n.default=s,cc._RF.pop()},{"../game/multiplayer-inst":"multiplayer-inst"}],lobby:[function(e,t,n){"use strict";cc._RF.push(t,"78e034AvURBA5StEBh6PAs6","lobby"),Object.defineProperty(n,"__esModule",{value:!0});var i=e("../core/transport-message"),r=e("../libs/Multiplayer"),o=e("./lobby-player-item"),s=e("../game/multiplayer-inst"),a=e("../core/event-manager"),l=e("../game/player"),c=cc._decorator,u=c.ccclass,p=c.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.gameMode=null,e.playerLeft=null,e.playerRight=null,e.startButton=null,e.players=[],e.mode=0,e}return __extends(e,t),e.prototype.onLoad=function(){this.players[0]={id:"",slot:this.playerLeft},this.players[1]={id:"",slot:this.playerRight},a.default.instance.register("multiplayer-message",this.onMpMessage,this)},e.prototype.start=function(){var e=i.default.instance.get("lobby","room"),t=JSON.parse(e);if(t){if(this.mode=t.type,1==t.type?this.gameMode.string="1 Shoot":this.gameMode.string="3 Shoot",2<t.players.length)return void cc.error("Invalid number player in room: "+t.players.length);for(var n=0;n<t.players.length;n++){var o=t.players[n];this.players[n].id=o.id,this.players[n].slot.setData(o.id,o.name,s.default.instance.manager.isMaster(o.id))}s.default.instance.manager.isMaster(s.default.instance.manager.getMyPlayer().id)?this.startButton.node.active=!0:this.startButton.node.active=!1}},e.prototype.onMpMessage=function(e,t){switch(e){case r.multiplayer.MessageCode.PLAYER_LEFT:for(var n=t,o=0;o<2;o++)this.players[o].id==n.id&&(this.players[o].id="",this.players[o].slot.setData(null,"",!1));break;case r.multiplayer.MessageCode.PLAYER_JOINED:for(n=t,o=0;o<2;o++){if(""==this.players[o].id){this.players[o].id=n.id,this.players[o].slot.setData(n.id,n.name,s.default.instance.manager.isMaster(n.id));break}1==o&&cc.warn("Player join but there have not slot")}break;case r.multiplayer.MessageCode.KICKED_OUT:s.default.instance.manager.quit(),cc.director.loadScene("main-menu");break;case r.multiplayer.MessageCode.GAME_STARTED:cc.log("Game start"),i.default.instance.send("gameplay","mode",""+this.mode),i.default.instance.send("gameplay","multiplayer","true"),cc.director.loadScene("game");break;case r.multiplayer.MessageCode.MASTER_ROOM_CHANGE:n=t;if(s.default.instance.manager.getMyPlayer().id==n.id){for(o=0;o<2;o++)""!=this.players[o].id&&this.players[o].id!=n.id?this.players[o].slot.setMaster(!1):this.players[o].id==n.id&&this.players[o].slot.setMaster(!0);this.startButton.node.active=!0}break;case r.multiplayer.MessageCode.DATA_RECIEVED:var a=t;JSON.parse(a.data).type===l.PlayerMessage.READY&&(s.default.instance.getPlayer(a.player.id).loaded=!0)}},e.prototype.onButtonQuitRoom=function(){s.default.instance.manager.quit(),i.default.instance.send("main-menu","page","1"),cc.director.loadScene("main-menu")},e.prototype.onButtonStartGame=function(){i.default.instance.send("gameplay","mode",""+this.mode),1==Object.keys(s.default.instance.players).length?(s.default.instance.reset(),cc.director.loadScene("game")):(i.default.instance.send("gameplay","multiplayer","true"),cc.director.loadScene("game"),s.default.instance.manager.startGame())},e.prototype.onDestroy=function(){a.default.instance.unregisterTarget(this)},__decorate([p(cc.Label)],e.prototype,"gameMode",void 0),__decorate([p(o.default)],e.prototype,"playerLeft",void 0),__decorate([p(o.default)],e.prototype,"playerRight",void 0),__decorate([p(cc.Button)],e.prototype,"startButton",void 0),e=__decorate([u],e)}(cc.Component);n.default=d,cc._RF.pop()},{"../core/event-manager":"event-manager","../core/transport-message":"transport-message","../game/multiplayer-inst":"multiplayer-inst","../game/player":"player","../libs/Multiplayer":"Multiplayer","./lobby-player-item":"lobby-player-item"}],"local-input":[function(e,t,n){"use strict";cc._RF.push(t,"27749qYLg9EJpFxSrupccJ0","local-input"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("./game"),a=e("../core/event-manager"),i=function(){function e(){this.player=null,this.rootNode=null,this.gameMode=null}return e.prototype.init=function(e,t){return this.player=e,this.gameMode=t,this.rootNode=cc.find("Canvas"),a.default.instance.registerOnce("start-countdown",this.onCountDown,this),a.default.instance.registerOnce("start-fight",this.onFight,this),this},e.prototype.onCountDown=function(){this.gameMode==o.GameMode.ONE_SHOOT?this.rootNode.once(cc.Node.EventType.TOUCH_START,this.onOneShoot,this):this.gameMode==o.GameMode.THREE_SHOOT&&a.default.instance.register("zone-touch",this.onThreeShoot,this)},e.prototype.onOneShoot=function(e){this.player.shoot1()},e.prototype.onThreeShoot=function(e){this.player.shoot3(0==e)},e.prototype.onFight=function(){cc.log("local start fight"),this.player.startFightTime=Date.now()},e}();n.LocalInput=i,cc._RF.pop()},{"../core/event-manager":"event-manager","./game":"game"}],"main-menu":[function(e,t,n){"use strict";cc._RF.push(t,"bdfcf0UCQ1HHqxptbWk0my2","main-menu"),Object.defineProperty(n,"__esModule",{value:!0});var a=e("../game/multiplayer-inst"),i=e("../core/transport-message"),o=e("../player-ref"),r=e("../core/popup"),s=e("../game/game"),l=e("../libs/Multiplayer"),c=cc._decorator,u=c.ccclass,p=c.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.leaderboard=null,e.findRoom=null,e.inputName=null,e.gameMode=null,e.playerName=null,e.help=null,e}return __extends(e,t),e.prototype.onLoad=function(){null==cc.sys.localStorage.getItem("user-name")?(this.inputName.active=!0,this.playerName.string="No name"):this.playerName.string=cc.sys.localStorage.getItem("user-name"),(cc.sys.localStorage.getItem("game-mode")?parseInt(cc.sys.localStorage.getItem("game-mode")):1)?this.gameMode.check():this.gameMode.uncheck()},e.prototype.start=function(){this.onGameModeChanged(null)},e.prototype.onButtonMostWanted=function(){cc.log("Button Most wanted"),this.leaderboard.active=!0},e.prototype.onButtonHelp=function(e,t){this.help.active="open"==t},e.prototype.onButtonFindRoom=function(){cc.log("Button Find room"),this.findRoom.active=!0},e.prototype.onButtonQuickPlay=function(){cc.log("Button Quick Join"),r.default.instance.showWaitingPopup("Finding online game...");var o=this.gameMode.isChecked?s.GameMode.ONE_SHOOT:s.GameMode.THREE_SHOOT;a.default.instance.manager.quickJoin(function(e,t){if(r.default.instance.hideWaitingPopup(),null==e)cc.log("Quick join success"),i.default.instance.send("lobby","room",JSON.stringify(t)),cc.director.loadScene("lobby");else{var n="";n=e.error==l.multiplayer.ErrorCode.NOT_SUPPORTED?"Your browser/device do not support WebRTC API so you can not play with others.\nDo you want to play with Boss (AI)":"There have no online room.\nDo you want to play with Boss (AI)",r.default.instance.showConfirmPopup(n,"Yes","No",function(){i.default.instance.send("gameplay","mode",""+o),cc.director.loadScene("game")})}},o)},e.prototype.onButtonCreateRoom=function(){cc.log("Button Create room");var e=this.gameMode.isChecked?1:3;a.default.instance.manager.createRoom("",function(e,t){null==e?(cc.log("Create room success"),i.default.instance.send("lobby","room",JSON.stringify(t)),cc.director.loadScene("lobby")):r.default.instance.showNotify(e.message)},2,e)},e.prototype.onButtonInputName=function(){var e=this.inputName.getComponentInChildren(cc.EditBox).string;cc.sys.localStorage.setItem("user-name",e),o.default.current.setName(e),a.default.instance.manager.setPlayerName(e),this.inputName.active=!1,this.playerName.string=e},e.prototype.onButtonEditName=function(){this.inputName.getComponentInChildren(cc.EditBox).string=cc.sys.localStorage.getItem("user-name"),this.inputName.active=!0},e.prototype.onGameModeChanged=function(e){this.gameMode.isChecked?(this.gameMode.node.getChildByName("1shoot").color=cc.color(255,255,255,255),this.gameMode.node.getChildByName("3shoot").color=cc.color(105,105,105,255)):(this.gameMode.node.getChildByName("3shoot").color=cc.color(255,255,255,255),this.gameMode.node.getChildByName("1shoot").color=cc.color(105,105,105,255)),cc.sys.localStorage.setItem("game-mode",this.gameMode.isChecked?1:0)},__decorate([p(cc.Node)],e.prototype,"leaderboard",void 0),__decorate([p(cc.Node)],e.prototype,"findRoom",void 0),__decorate([p(cc.Node)],e.prototype,"inputName",void 0),__decorate([p(cc.Toggle)],e.prototype,"gameMode",void 0),__decorate([p(cc.Label)],e.prototype,"playerName",void 0),__decorate([p(cc.Node)],e.prototype,"help",void 0),e=__decorate([u],e)}(cc.Component);n.default=d,cc._RF.pop()},{"../core/popup":"popup","../core/transport-message":"transport-message","../game/game":"game","../game/multiplayer-inst":"multiplayer-inst","../libs/Multiplayer":"Multiplayer","../player-ref":"player-ref"}],"multiplayer-inst":[function(e,t,n){"use strict";cc._RF.push(t,"b383d7hTlZCmbFp62HUeMTB","multiplayer-inst"),Object.defineProperty(n,"__esModule",{value:!0});var r=e("../libs/Multiplayer"),o=e("../config"),s=e("../player-ref"),l=e("./player"),c=e("../core/event-manager"),a=function(){function e(){this._impl=null,this.players={}}return Object.defineProperty(e,"instance",{get:function(){return null==this._instance&&(this._instance=new e,this._instance.init()),this._instance},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"manager",{get:function(){return this._impl},enumerable:!0,configurable:!0}),e.prototype.init=function(){this._impl=new r.multiplayer.Manager(o.default.PROJECT_ID),this._impl.onMessage=this.onMpMessage.bind(this)},e.prototype.onMpMessage=function(e,t){switch(e){case r.multiplayer.MessageCode.ROOM_CREATED:case r.multiplayer.MessageCode.ROOM_JOINED:if(null==t.error)for(var n=t.room,o=0;o<n.players.length;o++){var a=(i=n.players[o]).id===this._impl.getMyPlayer().id?l.PlayerType.LOCAL:l.PlayerType.REMOTE;this.players[i.id]=new l.default(i.id,i.name,a,!0)}break;case r.multiplayer.MessageCode.PLAYER_JOINED:var i=t;this.players[i.id]=new l.default(i.id,i.name,l.PlayerType.REMOTE,!0);break;case r.multiplayer.MessageCode.PLAYER_LEFT:i=t;this.players[i.id]?delete this.players[i.id]:cc.warn("Player not exist: "+i.id);break;case r.multiplayer.MessageCode.INITIALIZED:c.default.instance.dispatch("Multiplayer-init"),this._impl.setPlayerName(s.default.current.name),this._impl.setPlayerId(s.default.current.id)}c.default.instance.dispatch("multiplayer-message",e,t)},Object.defineProperty(e.prototype,"localPlayer",{get:function(){return this.players[this._impl.getMyPlayer().id]},enumerable:!0,configurable:!0}),e.prototype.getPlayer=function(e){return this.players[e]?this.players[e]:(cc.warn("Player is not exist"),null)},e.prototype.allPlayerReady=function(){var e=!0;for(var t in this.players)if(0==this.players[t].ready){e=!1;break}return e},e.prototype.amIMaster=function(){return this._impl.isMaster(this._impl.getMyPlayer().id)},e.prototype.reset=function(){this._impl.quit(),this.players={},c.default.instance.remove("multiplayer-message")},e.prototype.rematch=function(){for(var e in this.players){var t=this.players[e];this.players[e]=new l.default(t.id,t.name,t.type,t.multiplay)}c.default.instance.remove("multiplayer-message")},e.prototype.sendMessage=function(e,t){void 0===t&&(t=null),this._impl.sendMessage(JSON.stringify({type:e,data:t}))},e._instance=null,e}();n.default=a,cc._RF.pop()},{"../config":"config","../core/event-manager":"event-manager","../libs/Multiplayer":"Multiplayer","../player-ref":"player-ref","./player":"player"}],"player-behavior":[function(e,t,n){"use strict";cc._RF.push(t,"563a9EFk9hA7JYbAqPBjM/F","player-behavior"),Object.defineProperty(n,"__esModule",{value:!0});var o=cc._decorator,a=o.ccclass,i=o.property,r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.playerName=null,e.playerStatus=null,e.amatureDisplay=null,e.amature=null,e.loaded=!1,e.pendingAnim="",e}return __extends(e,t),e.prototype.onLoad=function(){this.amatureDisplay=this.getComponent(dragonBones.ArmatureDisplay),this.amature=this.amatureDisplay.armature(),this.amatureDisplay.addEventListener(dragonBones.EventObject.COMPLETE,this.onAnimationEvent,this),this.amatureDisplay.addEventListener(dragonBones.EventObject.START,this.onAnimationEvent,this),this.playerStatus.string="",this.setLoaded(this.loaded)},e.prototype.setPlayerName=function(e){this.playerName.string=e},e.prototype.setPlayerStatus=function(e){var t=this;this.playerStatus.string=e,this.scheduleOnce(function(){t.playerStatus.string=""},2)},e.prototype.setLoaded=function(e){this.loaded=e,this.amatureDisplay&&(this.amatureDisplay.enabled=e)},e.prototype.aimAndFire=function(){this.amature.animation.play("aim",1)},e.prototype.aimAndMiss=function(){this.amature.animation.play("aim",1)},e.prototype.fire=function(){this.amature.animation.play("fire",1)},e.prototype.death=function(e){e?this.amature.animation.play("suicide",1):this.amature.animation.play("death",1)},e.prototype.win=function(){this.amature.animation.isCompleted?this.amature.animation.play("victory",1):this.pendingAnim="victory"},e.prototype.onAnimationEvent=function(e){var t=e.detail;e.type===dragonBones.EventObject.COMPLETE?"aim"===t.animationState.name?this.amature.animation.play("fire",1):"fire"===t.animationState.name&&""!=this.pendingAnim&&(this.amature.animation.play(this.pendingAnim,1),this.pendingAnim=""):e.type===dragonBones.EventObject.START&&t.animationState.name},e.prototype.update=function(e){},__decorate([i(cc.Label)],e.prototype,"playerName",void 0),__decorate([i(cc.Label)],e.prototype,"playerStatus",void 0),e=__decorate([a],e)}(cc.Component);n.default=r,cc._RF.pop()},{}],"player-ref":[function(e,t,n){"use strict";cc._RF.push(t,"682d9kb909Cbr1Y2lUh8W/u","player-ref"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("./libs/firebase-inst"),a=e("./core/event-manager"),i=function(){function t(){this._id="",this._name="NickName"}return Object.defineProperty(t,"current",{get:function(){return null==this._current&&(this._current=new t,this._current.init(),this._current.authFirebase()),this._current},enumerable:!0,configurable:!0}),t.prototype.authFirebase=function(){null==o.default.app&&o.default.init(),o.default.app.auth().onAuthStateChanged(function(e){e&&(t.current.setId(e.uid),cc.log("Login anon success: "+e.uid),a.default.instance.dispatch("PlayerRef-init","success"))}),o.default.app.auth().signInAnonymously().catch(function(e){cc.warn("Authentication anon error: "+e.message)})},t.prototype.init=function(){null!=cc.sys.localStorage.getItem("user-name")&&(this._name=cc.sys.localStorage.getItem("user-name"))},Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),t.prototype.setId=function(e){this._id=e},Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),t.prototype.setName=function(e){this._name=e},t._current=null,t}();n.default=i,cc._RF.pop()},{"./core/event-manager":"event-manager","./libs/firebase-inst":"firebase-inst"}],player:[function(e,t,n){"use strict";cc._RF.push(t,"a3a50iqAUlCi668se2aXgAV","player"),Object.defineProperty(n,"__esModule",{value:!0});var o,a,i,r,s,l,c=e("../utils"),u=e("./multiplayer-inst");(a=o=n.PlayerType||(n.PlayerType={}))[a.LOCAL=0]="LOCAL",a[a.REMOTE=1]="REMOTE",a[a.BOSS=2]="BOSS",(r=i=n.PlayerMessage||(n.PlayerMessage={}))[r.READY=0]="READY",r[r.START=1]="START",r[r.START_FIGHT_TIME=2]="START_FIGHT_TIME",r[r.SHOOT_ONE=3]="SHOOT_ONE",r[r.SHOOT_THREE=4]="SHOOT_THREE",r[r.REMATCH=5]="REMATCH",(l=s=n.PlayerResult||(n.PlayerResult={}))[l.RAW=0]="RAW",l[l.WIN=1]="WIN",l[l.LOSE=2]="LOSE";var p=function(){function e(e,t,n,o){this.type=null,this.id="",this.name="",this._startFightTime=0,this.shootTime=0,this.ready=!1,this.multiplay=!1,this.firstShoot=!0,this.result=null,this.shootZone={safe:0,unsafe:0},this.behavior=null,this.id=e,this.name=t,this.type=n,this.multiplay=o}return Object.defineProperty(e.prototype,"startFightTime",{get:function(){return this._startFightTime},set:function(e){this.sendMessage(i.START_FIGHT_TIME,e),this._startFightTime=e},enumerable:!0,configurable:!0}),e.prototype.setBehavior=function(e){this.behavior=e,this.behavior.setPlayerName(this.name),this.behavior.setLoaded(this.ready)},Object.defineProperty(e.prototype,"loaded",{set:function(e){this.behavior&&this.behavior.setLoaded(e),e&&(this.ready=!0,this.sendMessage(i.READY,null))},enumerable:!0,configurable:!0}),e.prototype.setResult=function(e){switch(this.result=e){case s.RAW:case s.WIN:this.behavior.win();break;case s.LOSE:3==this.shootZone.unsafe?(this.behavior.death(!0),this.behavior.setPlayerStatus("Suicide")):this.behavior.death(!1)}},e.prototype.shoot1=function(e){void 0===e&&(e=null),this.result||(0!=this.startFightTime?(this.shootTime=e||Date.now()-this.startFightTime,this.shootTime==c.Constant.MAX_SAFE_INTEGER?(this.behavior.aimAndMiss(),this.behavior.setPlayerStatus("Miss")):this.firstShoot&&this.behavior.aimAndFire()):(this.shootTime=c.Constant.MAX_SAFE_INTEGER,this.behavior.aimAndMiss(),this.behavior.setPlayerStatus("Miss"),cc.log("miss fight")),cc.log(this.name+" shoot 1: "+this.shootTime),this.sendMessage(i.SHOOT_ONE,this.shootTime),this.firstShoot=!1)},e.prototype.shoot3=function(e,t){void 0===t&&(t=null),this.result||(this.shootTime=t||Date.now()-this.startFightTime,e?this.shootZone.safe++:this.shootZone.unsafe++,this.firstShoot?this.behavior.aimAndFire():this.behavior.fire(),this.sendMessage(i.SHOOT_THREE,{safe:e,time:this.shootTime}),this.firstShoot=!1)},e.prototype.sendMessage=function(e,t){this.type==o.LOCAL&&this.multiplay&&u.default.instance.sendMessage(e,t)},e}();n.default=p,cc._RF.pop()},{"../utils":"utils","./multiplayer-inst":"multiplayer-inst"}],popup:[function(e,t,n){"use strict";cc._RF.push(t,"bee021/s1xLdK4hWrNX3HTi","popup"),Object.defineProperty(n,"__esModule",{value:!0});var o=cc._decorator,a=o.ccclass,i=o.property,r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dialogPopup=null,e.waitingPopup=null,e.waitingPopupNode=null,e}return __extends(e,t),n=e,Object.defineProperty(e,"instance",{get:function(){return this._instance?this._instance:(cc.error("Popup does not init yet, this need to be init in loader"),null)},enumerable:!0,configurable:!0}),e.prototype.onLoad=function(){n._instance=this,cc.game.addPersistRootNode(this.node),this.node.setLocalZOrder(1e3)},e.prototype.showInfoPopup=function(e,t){var n=cc.instantiate(this.dialogPopup),o=n.getChildByName("blockinput").getComponent(cc.Widget);o.target=cc.find("Canvas"),o.left=0,o.right=0,n.getChildByName("content").getComponent(cc.Label).string=e,n.getChildByName("positivebutton").active=!1,n.getChildByName("negativebutton").active=!1,n.getChildByName("okbutton").getComponent(cc.Button).node.on("click",function(){n.removeFromParent(),t&&t()}),cc.find("Canvas").addChild(n)},e.prototype.showConfirmPopup=function(e,t,n,o,a){var i=cc.instantiate(this.dialogPopup),r=i.getChildByName("blockinput").getComponent(cc.Widget);r.target=cc.find("Canvas"),r.left=0,r.right=0,i.getChildByName("content").getComponent(cc.Label).string=e,i.getChildByName("okbutton").active=!1,i.getChildByName("positivebutton").getChildByName("Label").getComponent(cc.Label).string=t,i.getChildByName("negativebutton").getChildByName("Label").getComponent(cc.Label).string=n,i.getChildByName("positivebutton").getComponent(cc.Button).node.on("click",function(){i.removeFromParent(),o&&o()}),i.getChildByName("negativebutton").getComponent(cc.Button).node.on("click",function(){i.removeFromParent(),a&&a()}),cc.find("Canvas").addChild(i)},e.prototype.showWaitingPopup=function(e){var t=cc.instantiate(this.waitingPopup),n=t.getChildByName("blockinput").getComponent(cc.Widget);n.target=cc.find("Canvas"),n.left=0,n.right=0,t.getChildByName("content").getComponentInChildren(cc.Label).string=e,this.waitingPopupNode=t,cc.find("Canvas").addChild(t)},e.prototype.hideWaitingPopup=function(){this.waitingPopupNode.removeFromParent()},e.prototype.showNotify=function(e,t){void 0===t&&(t=3);var n=cc.instantiate(this.waitingPopup);n.getChildByName("blockinput").removeFromParent(),n.getChildByName("content").getComponentInChildren(cc.Label).string=e,cc.find("Canvas").addChild(n),this.scheduleOnce(function(){n.removeFromParent()},t)},e._instance=null,__decorate([i(cc.Prefab)],e.prototype,"dialogPopup",void 0),__decorate([i(cc.Prefab)],e.prototype,"waitingPopup",void 0),e=n=__decorate([a],e);var n}(cc.Component);n.default=r,cc._RF.pop()},{}],"remote-input":[function(e,t,n){"use strict";cc._RF.push(t,"a555alw6blLGLxbfT2YqFTg","remote-input"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("../core/event-manager"),a=e("../libs/Multiplayer"),i=e("./player"),r=e("./multiplayer-inst"),s=function(){function e(){}return e.prototype.init=function(){o.default.instance.register("multiplayer-message",this.onMessage,this)},e.prototype.onMessage=function(e,t){if(e==a.multiplayer.MessageCode.DATA_RECIEVED){var n=t,o=JSON.parse(n.data);switch(cc.log("remote "+n.player.name+" has message: "+n.data),o.type){case i.PlayerMessage.START_FIGHT_TIME:r.default.instance.getPlayer(n.player.id).startFightTime=o.data;break;case i.PlayerMessage.READY:r.default.instance.getPlayer(n.player.id).loaded=!0;break;case i.PlayerMessage.SHOOT_ONE:r.default.instance.getPlayer(n.player.id).shoot1(o.data);break;case i.PlayerMessage.SHOOT_THREE:r.default.instance.getPlayer(n.player.id).shoot3(o.data.safe,o.data.time)}}},e}();n.default=s,cc._RF.pop()},{"../core/event-manager":"event-manager","../libs/Multiplayer":"Multiplayer","./multiplayer-inst":"multiplayer-inst","./player":"player"}],"room-item":[function(e,t,n){"use strict";cc._RF.push(t,"2b8bcX3T3hHirk3YykH2yGc","room-item"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("../game/multiplayer-inst"),a=e("../core/transport-message"),i=e("../core/popup"),r=cc._decorator,s=r.ccclass,l=r.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nickname=null,e.type=null,e.player=null,e.id="",e}return __extends(e,t),e.prototype.setData=function(e,t,n,o){this.id=e,this.nickname.string=t,this.player.string=o,this.type.string=1==n?"1Shoot":"3Shoot"},e.prototype.onButtonJoin=function(){cc.log("Join room: "+this.id),i.default.instance.showWaitingPopup("Connecting..."),o.default.instance.manager.joinRoom(this.id,function(e,t){i.default.instance.hideWaitingPopup(),null==e?(a.default.instance.send("lobby","room",JSON.stringify(t)),cc.director.loadScene("lobby")):i.default.instance.showNotify(e.message)})},__decorate([l(cc.Label)],e.prototype,"nickname",void 0),__decorate([l(cc.Label)],e.prototype,"type",void 0),__decorate([l(cc.Label)],e.prototype,"player",void 0),e=__decorate([s],e)}(cc.Component);n.default=c,cc._RF.pop()},{"../core/popup":"popup","../core/transport-message":"transport-message","../game/multiplayer-inst":"multiplayer-inst"}],"rooms-find":[function(e,t,n){"use strict";cc._RF.push(t,"af67c2BDYtCm4tfEctee6ji","rooms-find"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("../game/multiplayer-inst"),i=e("./room-item"),a=cc._decorator,r=a.ccclass,s=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.roomItem=null,e.statusText=null,e}return __extends(e,t),e.prototype.onLoad=function(){this.anim=this.node.getComponent(cc.Animation),this.content=this.node.getComponentInChildren(cc.Layout)},e.prototype.getLobbies=function(){var a=this;this.content.node.removeAllChildren(),this.statusText.node.active=!1,o.default.instance.manager.getRooms(function(e){0==e.length&&(a.statusText.node.active=!0),e.forEach(function(e){var t=cc.instantiate(a.roomItem),n=e.master.name,o=e.playerInRoom+"/"+e.maxPlayer;t.getComponent(i.default).setData(e.id,n,e.type,o),a.content.node.addChild(t)}),a.content.node.parent.getComponent(cc.ScrollView).scrollToTop()})},e.prototype.onButtonClose=function(){var t=this;this.anim.play(this.anim.defaultClip.name).wrapMode=cc.WrapMode.Reverse,this.anim.once("finished",function(e){t.node.active=!1})},e.prototype.onEnable=function(){this.anim.play(this.anim.defaultClip.name).wrapMode=cc.WrapMode.Normal,this.getLobbies()},__decorate([s(cc.Prefab)],e.prototype,"roomItem",void 0),__decorate([s(cc.Label)],e.prototype,"statusText",void 0),e=__decorate([r],e)}(cc.Component);n.default=l,cc._RF.pop()},{"../game/multiplayer-inst":"multiplayer-inst","./room-item":"room-item"}],tapzone:[function(e,t,n){"use strict";cc._RF.push(t,"d3df2VlbbNBaolhb/YTn59W","tapzone"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("../core/event-manager"),a=cc._decorator,i=a.ccclass,r=(a.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=-1,e}return __extends(e,t),(n=e).prototype.onLoad=function(){this.node.on("click",this.onClick,this),o.default.instance.register("zone-destroy",this.destroyZone,this)},e.prototype.setType=function(e){0==(this.type=e)?this.node.color=n.safeColor:1==e&&(this.node.color=n.dangColor)},e.prototype.onClick=function(){this.getComponent(cc.Button).enabled=!1,o.default.instance.dispatch("zone-touch",this.type),this.node.removeFromParent()},e.prototype.destroyZone=function(){this.node.removeFromParent()},e.prototype.onDestroy=function(){o.default.instance.unregisterTarget(this)},e.safeColor=cc.color(125,202,27,255),e.dangColor=cc.color(218,106,44,255),e=n=__decorate([i],e);var n}(cc.Component));n.default=r;var s=function(){function e(){}return e.generateZone=function(e){for(var t=[],n=[],o=cc.director.getVisibleSize(),a=cc.rect(.75*this.width,.75*this.height,o.width-this.width/2,o.height-this.height/2),i=0;i<e;i++)for(var r=Math.floor(cc.random0To1()*o.width),s=Math.floor(cc.random0To1()*o.height);;){if(a.contains(cc.v2(r,s))){for(var l=!0,c=0;c<t.length;c++){var u=t[c];if(Math.abs(r-u.x)<.75*this.width||Math.abs(s-u.y)<.75*this.height){l=!1;break}}if(l){n.push({x:r-o.width/2,y:s-o.height/2}),t.push({x:r,y:s});break}}r=Math.floor(cc.random0To1()*o.width),s=Math.floor(cc.random0To1()*o.height)}return n},e.width=80,e.height=80,e.tapzone=[],e}();n.TapZoneGen=s,cc._RF.pop()},{"../core/event-manager":"event-manager"}],"transport-message":[function(e,t,n){"use strict";cc._RF.push(t,"e8a69h3FD5LjqkRXtnwnMR+","transport-message"),Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(){this._messages={}}return Object.defineProperty(e,"instance",{get:function(){return null==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.send=function(e,t,n){void 0===n&&(n=""),this._messages[e]||(this._messages[e]={}),this._messages[e][t]=n},e.prototype.get=function(e,t,n){return void 0===n&&(n=!0),this._messages[e]&&null!=this._messages[e][t]?this._messages[e][t]:null},e._instance=null,e}();n.default=o,cc._RF.pop()},{}],utils:[function(e,t,n){"use strict";cc._RF.push(t,"f2478RnGaxHz76Y1Z/BRWz8","utils"),Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){void 0===t&&(t=!1),this.unique=[],this.initLength=-1,this.recycle=!1,this.initLength=e,this.recycle=t;for(var n=0;n<e;n++)this.unique[n]=n}return e.prototype.random=function(){if(0==this.unique.length){if(!this.recycle||-1==this.initLength)return-1;for(var e=0;e<this.initLength;e++)this.unique[e]=e}var t=Math.floor(cc.random0To1()*(this.unique.length-1)),n=this.unique[t];return this.unique.splice(t,1),n},e}();n.RandomUnique=o;var a=function(){function e(){}return e.MAX_SAFE_INTEGER=9007199254740991,e.MIN_SAFE_INTEGER=-9007199254740991,e}();n.Constant=a,cc._RF.pop()},{}]},{},["config","event-manager","loader","popup","transport-message","boss-input","count-down","game","local-input","multiplayer-inst","player-behavior","player","remote-input","tapzone","Multiplayer","firebase-inst","leaderboard-db","animation-in-out","lb-item","leaderboard","lobby-player-item","lobby","main-menu","room-item","rooms-find","player-ref","utils"]);